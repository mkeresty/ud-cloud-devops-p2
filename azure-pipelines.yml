# Azure DevOps Pipeline configuration
name: Python application test

trigger:
- '*'  # Triggers on any branch push

# Use a free self-hosted agent to avoid parallelism limits
pool:
  name: Default  # Use a self-hosted agent pool

jobs:
- job: TestJob
  displayName: 'Test Python Application'
  
  # Force jobs to run sequentially even if multiple agents are available
  strategy:
    maxParallel: 1
    
  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.13.2'
      addToPath: true
    displayName: 'Set up Python 3.13.2'
  
  - script: |
      make install
    displayName: 'Install dependencies'
  
  - script: |
      make lint
    displayName: 'Lint with pylint'
  
  - script: |
      make test
    displayName: 'Test with pytest'